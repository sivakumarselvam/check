<!doctype html>
<html lang="ta">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>மாங்காய் ஊறுகாய் — உடனடி ஆர்டர்</title>
  <style>
    :root{--accent:#d35400}
    body{font-family:system-ui,-apple-system,Segoe UI, Roboto; padding:20px; color:#111; background:#fff; display:flex; align-items:center; justify-content:center; min-height:100vh}
    .card{width:100%;max-width:520px;border-radius:12px;padding:20px;border:1px solid #eee;box-shadow:0 6px 18px rgba(0,0,0,0.04)}
    h1{font-size:24px;margin:4px 0 6px;text-align:center}
    p.lead{color:#555;margin:0 0 14px;text-align:center;font-size:15px}
    .product{padding:12px;border-radius:10px;border:1px solid #f5f5f5;background:#fff;display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .product .info{flex:1}
    .product .title{font-weight:800;font-size:18px}
    .product .meta{color:#666;font-size:14px;margin-top:6px}
    .qty-row{display:flex;align-items:center;justify-content:center;gap:12px;margin-top:10px}
    .qty-btn{width:44px;height:44px;border-radius:8px;border:1px solid #ddd;background:#fff;font-size:20px;cursor:pointer}
    .qty-display{min-width:140px;text-align:center;font-weight:700;font-size:16px}
    textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc;margin-top:10px;resize:vertical}
    .btn{display:inline-block;background:var(--accent);color:#fff;padding:12px 18px;border-radius:8px;border:none;font-weight:700;font-size:16px;cursor:pointer;text-decoration:none;margin-top:14px;width:100%}
    .small{font-size:13px;color:#666;margin-top:10px;text-align:center}
    .link{color:#0b64c6;word-break:break-all}
    #fallback{display:none;margin-top:12px;text-align:center}
    #status{margin-top:12px;text-align:center;font-weight:700}
    .actions{display:flex;gap:8px;margin-top:10px}
    .actions button{flex:1;padding:10px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer}
    @media (max-width:420px){ .qty-display{min-width:110px} h1{font-size:20px} .actions{flex-direction:column} }
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="pageTitle">
    <h1 id="pageTitle">மாங்காய் ஊறுகாய்</h1>
    <p class="lead">அளவு அடிப்படை: 5 கிலோ. எண்ணிக்கை அதிகமா? '+' அழுத்தி கூட்டவும். எதையும் பகிர வேண்டாம்.</p>

    <div class="product" aria-hidden="false">
      <div class="info">
        <div class="title">மாங்காய் ஊறுகாய்</div>
        <div class="meta">ஒன்றின் அளவு: 5 கிலோ</div>
      </div>
    </div>

    <!-- Quantity controls: each unit = 5 KG -->
    <div style="margin-top:6px; text-align:center;">
      <label for="qty" style="font-weight:700;color:#333;display:block;margin-bottom:8px">அளவு தேர்வு (கிலோகிராம்)</label>
      <div class="qty-row" role="group" aria-label="அளவு">
        <button id="decr" class="qty-btn" aria-label="குறைக்க" title="குறைக்க">−</button>
        <div class="qty-display" id="qtyDisplay" aria-live="polite">5 கிலோ</div>
        <button id="incr" class="qty-btn" aria-label="சேர்க்க" title="சேர்க்க">＋</button>
      </div>
      <div style="margin-top:8px;text-align:center;color:#666;font-size:13px">குறைந்தபட்சம் 5 கிலோ. ஒவ்வொரு கிளிக் 5 கிலோ ஆகும்.</div>
    </div>

    <!-- Optional delivery address only (not required) -->
    <label for="address" style="font-weight:600;color:#333;display:block;margin-top:14px">முகவரி / குறிப்பு (விரும்பின் மட்டும்)</label>
    <textarea id="address" rows="3" placeholder="வீட்டு முகவரி, நகரம், PIN அல்லது குறிப்புகள் (விருப்பம்)"></textarea>

    <div style="margin-top:12px">
      <button class="btn" id="submitBtn">ஆர்டர் அனுப்பு</button>
    </div>

    <div class="actions" aria-hidden="false">
      <button id="copyMsgBtn" title="செய்கை செய்தியை நகலெடுக்க">செய்தியை நகலெடுக்க</button>
      <button id="showLinksBtn" title="கைமுறை லிங்குகளை காண்பி">மூலத்தின்மேல் கிளிக்</button>
    </div>

    <p class="small">குறிப்பு: கீழே உள்ளது பயனர்-பக்கம் மட்டும். இரண்டு வாட்ஸ்அப் நம்பர்களுக்கும் குறு-வருகை திறக்க முயற்சிக்கப்படும்; சில மொபைல் உலாவிகள் popup-ஐ தடை செய்தால் இரண்டாவது சாட் தானாக திறக்கப்படாது. (பயனர் ஒவ்வொரு சாட்டிலும் 'Send' தட்ட வேண்டும்)</p>

    <div id="status" role="status" aria-live="polite"></div>

    <div id="fallback">
      <p class="small">மனுவல் லிங்குகள் (தொலைபேசி மாற்றங்கள் செய்ய PHONE1/PHONE2 மதிப்புகளை நிரலிலே மாற்றவும்):</p>
      <div><a id="link1" class="link" target="_blank" rel="noopener"></a></div>
      <div style="margin-top:6px"><a id="link2" class="link" target="_blank" rel="noopener"></a></div>
    </div>
  </div>

  <script>
    // === IMPORTANT: Replace these two phone values with the two target numbers you want to notify.
    // Use international format digits only (country code + number), no '+' and no spaces.
    // Example: "919812345678"
    const PHONE1 = "916364802223"; // first target (your original)
    const PHONE2 = "919448509719"; // second target: replace this

    // Quantity logic
    let units = 1;
    const UNIT_KG = 5;

    const qtyDisplay = document.getElementById('qtyDisplay');
    const incrBtn = document.getElementById('incr');
    const decrBtn = document.getElementById('decr');
    const submitBtn = document.getElementById('submitBtn');
    const statusEl = document.getElementById('status');
    const fallback = document.getElementById('fallback');
    const link1 = document.getElementById('link1');
    const link2 = document.getElementById('link2');
    const copyMsgBtn = document.getElementById('copyMsgBtn');
    const showLinksBtn = document.getElementById('showLinksBtn');

    function renderQty(){
      const kg = units * UNIT_KG;
      qtyDisplay.textContent = `${kg} கிலோ`;
      decrBtn.disabled = units <= 1;
      decrBtn.style.opacity = units <= 1 ? 0.5 : 1;
    }

    incrBtn.addEventListener('click', () => { units += 1; renderQty(); });
    decrBtn.addEventListener('click', () => { if(units > 1){ units -= 1; renderQty(); } });
    renderQty();

    function buildMessageText(){
      const product = "மாங்காய் ஊறுகாய்";
      const totalKg = units * UNIT_KG;
      const address = document.getElementById('address').value.trim();

      let text = "ஆர்டர்:\n";
      text += product + "\n";
      text += "அளவு: " + totalKg + " கிலோ\n";
      if(address) text += "முகவரி: " + address + "\n";
      text += "\nதயவு செய்து விநியோகமும் தொகையும் உறுதிசெய்க.";
      return text;
    }

    function makeWaLink(phone, text){
      // phone should be digits only (country code + number)
      return `https://wa.me/${phone}?text=${encodeURIComponent(text)}`;
    }

    async function tryOpenTwoChats(){
      // Validate PHONEs
      if(!/^\d+$/.test(PHONE1) || !/^\d+$/.test(PHONE2) || PHONE2 === "REPLACE_WITH_SECOND_NUMBER"){
        alert('Owner: தயவு செய்து PHONE1 மற்றும் PHONE2 ஆகியவற்றை HTML இல் எண்களாகச் சரியாக அமைக்கவும் (உதா: 919812345678).');
        return;
      }

      const text = buildMessageText();
      const link1Url = makeWaLink(PHONE1, text);
      const link2Url = makeWaLink(PHONE2, text);

      statusEl.textContent = "வாட்ஸ்அப்புகள் திறக்கப்படுகின்றன — ஒவ்வொரு சாட்-இலும் Send தட்ட நினைவில் வையுங்கள்...";
      // Attempt to open second chat in a new tab/window first (may be blocked)
      try {
        const w = window.open(link2Url, '_blank');
        // Redirect this tab to first chat (this typically opens WhatsApp app)
        window.location.href = link1Url;
        // Show fallback links after short delay in case popup blocked
        setTimeout(() => {
          link1.href = link1Url; link1.textContent = link1Url;
          link2.href = link2Url; link2.textContent = link2Url;
          fallback.style.display = 'block';
        }, 900);
      } catch (e) {
        // If anything fails, show links for manual use
        link1.href = link1Url; link1.textContent = link1Url;
        link2.href = link2Url; link2.textContent = link2Url;
        fallback.style.display = 'block';
        statusEl.textContent = "தொலைபேசி உலாவி சில popup-ஐ தடுத்தது; கீழ் லிங்குகளைத் திறக்கவும்.";
      }
    }

    // copy message text to clipboard (for user convenience)
    copyMsgBtn.addEventListener('click', async () => {
      try {
        const text = buildMessageText();
        await navigator.clipboard.writeText(text);
        statusEl.textContent = "செய்தி நகலெடுக்கப்பட்டது — WhatsApp-இல் ஒட்டவும் (Paste) மற்றும் Send ஐ தட்டவும்.";
      } catch (e){
        statusEl.textContent = "கிளிப்போர்டு போக்குவரத்து தோல்வி; கீழ் 'மூலத்தின்மேல் கிளிக்' பயன்படுத்தவும்.";
      }
    });

    // show manual wa.me links
    showLinksBtn.addEventListener('click', () => {
      const text = buildMessageText();
      const link1Url = makeWaLink(PHONE1, text);
      const link2Url = makeWaLink(PHONE2, text);
      link1.href = link1Url; link1.textContent = link1Url;
      link2.href = link2Url; link2.textContent = link2Url;
      fallback.style.display = 'block';
      statusEl.textContent = "கைமுறை லிங்குகள் கீழே காணப்படுகின்றன.";
    });

    // main submit button tries to open both chats
    submitBtn.addEventListener('click', tryOpenTwoChats);
  </script>
</body>
</html>\
